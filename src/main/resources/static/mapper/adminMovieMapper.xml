<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.eutchapedia.admin.movie.dao.MovieDao">
	<!-- 영화목록페이징 -->
	<resultMap
		type="kr.or.eutchapedia.admin.movie.entity.MovieInfo" id="moviepage">
		<id column="id" property="id" />
		<result column="NUM" property="num" />
		<result column="MOVIE_DOCID" property="movie_docid" />
		<result column="TITLE" property="title" />
		<result column="TITLE_ORG" property="title_Org" />
		<result column="NATION" property="nation" />
		<result column="MOVIE_RUNNING_TIME"
			property="movie_running_time" />
		<result column="RATING" property="rating" />
		<result column="PRODYEAR" property="prodyear" />
		<result column="POSTER_URI" property="poster_uri" />
		<result column="GENRE" property="genre" />
		<result column="PLOT" property="plot" />
		<result column="MOVIE_TRAILER" property="movie_trailer" />
		<result column="MOVIE_HIT_COUNT" property="movie_hit_count" />
	</resultMap>
	<!-- 영화총갯수 -->
	<resultMap
		type="kr.or.eutchapedia.admin.movie.entity.MovieCount" id="moviecount">
		<result column="NUM" property="num" />
	</resultMap>

	<!-- 픽정보 페이징 -->
	<resultMap
		type="kr.or.eutchapedia.admin.movie.entity.PickInfo" id="pickinfo">
		<result column="NUM" property="num" />
		<result column="PICK_INDEX" property="pickIndex" />
		<result column="FK_MEMBER_EMAIL" property="fkMemberEmail" />
		<result column="PICK_NAME" property="pickName" />
	</resultMap>

	<!-- movie리스트뽑아오기 -->
	<select id="getmovieList" resultMap="moviepage"
		parameterType="map">

		SELECT * FROM(
		SELECT ROWNUM NUM, m.*
		FROM (SELECT *
		FROM MOVIE_INFO WHERE
		${field} LIKE '%'||#{query}||'%'
		) m
		)
		WHERE NUM BETWEEN #{page} AND
		#{amount}

	</select>
	<select id="getmovieCount" resultMap="moviecount"
		parameterType="map">
		SELECT * FROM(
		SELECT ROWNUM NUM, m.*
		FROM (SELECT *
		FROM MOVIE_INFO WHERE
		${field} LIKE '%'||#{query}||'%'
		) m
		)
	</select>
	<!-- 픽리스트 페이징 -->
	<select id="getPickInfoList" resultMap="pickinfo"
		parameterType="map">
		SELECT * FROM(
		SELECT ROWNUM NUM, m.*
		FROM (SELECT *
		FROM PICK
		) m
		)
		WHERE NUM BETWEEN #{page} AND #{amount}
	</select>



</mapper>